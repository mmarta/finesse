<!DOCTYPE html>
<html>
	<head>
		<title>Finesse Test Page</title>
		<meta charset="utf-8" />
	</head>
	<body>
		<div id="placeForDisplay1"></div>
		<script src="finesse.js"></script>
		<script>
			//Set up Finesse display
			var display1 = Finesse.createPageDisplay(224, 256);
			//Finesse.addPageDisplayToElement(display1, 'placeForDisplay1');

			//Set up other vars
			var bgY = 0;
			var bgColor = Finesse.createRGBColorHexString(0, 0, 64);
			var sprite = new Image(),
				tile = new Image(),
				tileArrayA = [],
				tileArrayB = [];
			sprite.src = 'sprite.png';
			tile.src = 'tile.png';

			tileArrayA.push([[0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0]]);
			tileArrayA.push([[1, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [1, 0]]);
			tileArrayA.push([[1, 0], [1, 0], [1, 0], [1, 0], [1, 0], [1, 0], [1, 0], [1, 0], [2, 0], [2, 0], [2, 0], [2, 0], [3, 0], [3, 0], [3, 0], [3, 0], [2, 0], [2, 0], [2, 0], [2, 0], [1, 0], [1, 0], [1, 0], [1, 0], [1, 0], [1, 0], [1, 0], [1, 0]]);
			tileArrayA.push([[1, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [1, 0]]);

			tileArrayB.push([[0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0]]);
			tileArrayB.push([[1, 3], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [1, 3]]);
			tileArrayB.push([[1, 3], [1, 3], [1, 3], [1, 3], [1, 3], [1, 3], [1, 3], [1, 3], [2, 3], [2, 3], [2, 3], [2, 3], [3, 3], [3, 3], [3, 3], [3, 3], [2, 3], [2, 3], [2, 3], [2, 3], [1, 3], [1, 3], [1, 3], [1, 3], [1, 3], [1, 3], [1, 3], [1, 3]]);
			tileArrayB.push([[1, 3], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [1, 3]]);

			Finesse.registerTiledBackgroundLayer(display1, 'rows', tile, tileArrayA, 8, true);
			Finesse.registerTiledBackgroundLayer(display1, 'behindRows', tile, tileArrayB, 8, true);

			//Actual Finesse program
			var programLoop = function() {
				bgY += 2;
				Finesse.scrollBackground(display1, 'behindRows', 0, bgY >> 1);
				Finesse.scrollBackground(display1, 'rows', 0, bgY);

				Finesse.clearDisplayPage(display1, bgColor);
				Finesse.drawBackgroundLayer(display1, 'behindRows');
				Finesse.drawBackgroundLayer(display1, 'rows');
				Finesse.drawSpriteToPageDisplay(display1, sprite, 0, 0, 108, 224, 8, 8);
				Finesse.renderPageDisplay(display1);
				Finesse.waitNextFrame();
			};

			//Resize window event
			window.onresize = function() {
				Finesse.resizeSimulatedFullScreenPageDisplay(display1);
			}

			if(!Finesse.registerUpdateMode(Finesse.UPDATE_MODE_SCREEN_SYNC)) {
				throw "ERROR: No good!";
			}
			Finesse.simulateFullScreenPageDisplay(display1);
			Finesse.runPogramLoop(programLoop);
		</script>
</html>
